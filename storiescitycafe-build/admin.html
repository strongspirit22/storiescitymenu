<!doctype html><html lang="ru"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Stories City Cafe — Admin</title><link rel="icon" href="assets/logo.png"/><script src="https://cdn.tailwindcss.com"></script><script>tailwind.config={theme:{extend:{colors:{brand:{bg:"#0b0b0c",text:"#e5e7eb"}},boxShadow:{card:"0 10px 24px rgba(0,0,0,.25)"}}}}</script><style>:root{--grad:linear-gradient(90deg,#74D7EE,#9BE7D0,#F6C6A1,#F29AC1,#9C8CF5)}.btn-grad{background:var(--grad);color:#0b0b0c}</style></head><body class="bg-[color:var(--brand-bg,#0b0b0c)] text-brand-text"><div id="root"></div><script src="https://unpkg.com/react@18/umd/react.development.js"></script><script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script><script src="https://unpkg.com/@babel/standalone/babel.min.js"></script><script type="text/babel">
const {useEffect,useState}=React;function useAuth(){const[ok,setOk]=useState(false);function login(u,p){if(u==='storiescity'&&p==='goodtimes'){localStorage.setItem('stories_admin','1');setOk(true)}else alert('Неверный логин или пароль')}React.useEffect(()=>{if(localStorage.getItem('stories_admin')==='1')setOk(true)},[]);function logout(){localStorage.removeItem('stories_admin');setOk(false)}return{ok,login,logout}}
function App(){const{ok,login,logout}=useAuth();const[data,setData]=useState(null);const[filter,setFilter]=useState('');const[edit,setEdit]=useState(null);React.useEffect(()=>{fetch('menu.json').then(r=>r.json()).then(j=>{const saved=localStorage.getItem('stories_menu');setData(saved?JSON.parse(saved):j)})},[]);if(!ok)return(<div className="max-w-md mx-auto mt-16 bg-white/5 border border-white/10 p-6 rounded-2xl"><h2 className="text-xl font-bold mb-4">Вход администратора</h2><input defaultValue="storiescity" className="w-full mb-2 bg-black/30 border border-gray-700 rounded-xl px-3 py-2" placeholder="Логин"/><input defaultValue="goodtimes" type="password" className="w-full mb-4 bg-black/30 border border-gray-700 rounded-xl px-3 py-2" placeholder="Пароль"/><button className="btn-grad px-4 py-2 rounded-lg w-full" onclick="(function(){const u=document.querySelector('input[placeholder=\'Логин\']').value;const p=document.querySelector('input[placeholder=\'Пароль\']').value;if(u==='storiescity'&&p==='goodtimes'){localStorage.setItem('stories_admin','1');location.reload()}else alert('Неверный логин или пароль')})()">Войти</button></div>);if(!data)return <div className="p-6">Loading…</div>;
function saveLocal(){localStorage.setItem('stories_menu',JSON.stringify(data));alert('Сохранено в браузере')}function exportJSON(){const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='menu.json';a.click()}function addCategory(){const ru=prompt('Название категории (RU)');if(!ru)return;const en=prompt('Название категории (EN)',ru)||ru;const id=ru.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/^-+|-+$/g,'');data.categories.push({id,title_ru:ru,title_en:en});setData({...data})}function delCategory(i){if(!confirm('Удалить категорию и её блюда?'))return;const id=data.categories[i].id;data.items=data.items.filter(x=>x.category!==id);data.categories.splice(i,1);setData({...data})}function moveCategory(i,d){const j=i+d;if(j<0||j>=data.categories.length)return;const tmp=data.categories[i];data.categories[i]=data.categories[j];data.categories[j]=tmp;setData({...data})}function addItem(){const ru=prompt('Название блюда (RU)');if(!ru)return;const en=prompt('Название блюда (EN)',ru)||ru;const cat=prompt('ID категории',data.categories[0]?.id||'');if(!cat)return;const price=parseInt(prompt('Цена, UZS','0'))||0;const id=ru.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/^-+|-+$/g,'');data.items.push({id,category:cat,title_ru:ru,title_en:en,desc_ru:'',desc_en:'',price,tags:[]});setData({...data})}function editItem(it){setEdit({...it})}function saveItem(){const idx=data.items.findIndex(x=>x.id===edit.id);if(idx>=0){data.items[idx]=edit;setData({...data});setEdit(null)}}function delItem(id){if(!confirm('Удалить блюдо?'))return;data.items=data.items.filter(x=>x.id!==id);setData({...data})}
const items=data.items.filter(x=>!filter||(x.title_ru+x.title_en+(x.desc_ru||'')+(x.desc_en||'')).toLowerCase().includes(filter.toLowerCase()));
return(<div className="max-w-6xl mx-auto p-6 text-gray-100"><header className="flex items-center justify-between mb-4"><div className="flex items-center gap-3"><img src="assets/logo.png" className="w-12 h-12 rounded-xl"/><div className="text-xl font-bold">Admin — Stories City Cafe</div></div><div className="flex gap-2"><button className="px-3 py-2 rounded-lg border border-white/10" onClick={saveLocal}>Сохранить</button><button className="px-3 py-2 rounded-lg border border-white/10" onClick={exportJSON}>Экспорт menu.json</button><button className="px-3 py-2 rounded-lg border border-white/10" onClick={logout}>Выйти</button></div></header><section className="bg-white/5 border border-white/10 rounded-2xl p-4 mb-4"><h3 className="font-semibold mb-2">Настройки</h3><div className="grid sm:grid-cols-2 gap-2">
{["restaurantName","currency","phone","booking_link","telegram_bot","instagram","tripadvisor"].map(k=>(<label key={k} className="text-sm text-gray-300 flex flex-col"><span className="text-gray-400">{k}</span><input className="bg-black/30 border border-white/10 rounded-lg px-3 py-2" value={data.settings[k]||''} onChange={e=>{data.settings[k]=e.target.value;setData({...data})}}/></label>))}
<label className="text-sm text-gray-300 flex flex-col"><span className="text-gray-400">address_ru</span><input className="bg-black/30 border border-white/10 rounded-lg px-3 py-2" value={data.settings.address_ru||''} onChange={e=>{data.settings.address_ru=e.target.value;setData({...data})}}/></label>
<label className="text-sm text-gray-300 flex flex-col"><span className="text-gray-400">address_en</span><input className="bg-black/30 border border-white/10 rounded-lg px-3 py-2" value={data.settings.address_en||''} onChange={e=>{data.settings.address_en=e.target.value;setData({...data})}}/></label>
<label className="text-sm text-gray-300 flex flex-col"><span className="text-gray-400">hours_ru</span><input className="bg-black/30 border border-white/10 rounded-lg px-3 py-2" value={data.settings.hours_ru||''} onChange={e=>{data.settings.hours_ru=e.target.value;setData({...data})}}/></label>
<label className="text-sm text-gray-300 flex flex-col"><span className="text-gray-400">hours_en</span><input className="bg-black/30 border border-white/10 rounded-lg px-3 py-2" value={data.settings.hours_en||''} onChange={e=>{data.settings.hours_en=e.target.value;setData({...data})}}/></label>
<div className="grid grid-cols-2 gap-2"><label className="text-sm text-gray-300 flex flex-col"><span className="text-gray-400">lat</span><input className="bg-black/30 border border-white/10 rounded-lg px-3 py-2" value={data.settings.coords.lat} onChange={e=>{data.settings.coords.lat=parseFloat(e.target.value||0);setData({...data})}}/></label><label className="text-sm text-gray-300 flex flex-col"><span className="text-gray-400">lng</span><input className="bg-black/30 border border-white/10 rounded-lg px-3 py-2" value={data.settings.coords.lng} onChange={e=>{data.settings.coords.lng=parseFloat(e.target.value||0);setData({...data})}}/></label></div></div></section>
<section className="bg-white/5 border border-white/10 rounded-2xl p-4 mb-4"><div className="flex items-center justify-between mb-2"><h3 className="font-semibold">Категории</h3><div className="flex gap-2"><button className="px-3 py-2 rounded-lg border border-white/10" onClick={addCategory}>Добавить</button></div></div><div className="space-y-2">{data.categories.map((c,i)=>(<div key={c.id} className="flex items-center gap-2"><div className="flex-1 grid grid-cols-3 gap-2"><input className="bg-black/30 border border-white/10 rounded-lg px-3 py-2" value={c.id} onChange={e=>{c.id=e.target.value;setData({...data})}}/><input className="bg-black/30 border border-white/10 rounded-lg px-3 py-2" value={c.title_ru} onChange={e=>{c.title_ru=e.target.value;setData({...data})}}/><input className="bg-black/30 border border-white/10 rounded-lg px-3 py-2" value={c.title_en} onChange={e=>{c.title_en=e.target.value;setData({...data})}}/></div><button className="px-2 py-1 rounded-lg border border-white/10" onClick={()=>moveCategory(i,-1)}>↑</button><button className="px-2 py-1 rounded-lg border border-white/10" onClick={()=>moveCategory(i,1)}>↓</button><button className="px-2 py-1 rounded-lg border border-white/10" onClick={()=>delCategory(i)}>Удалить</button></div>))}</div></section>
<section className="bg-white/5 border border-white/10 rounded-2xl p-4"><div className="flex items-center justify-between mb-2"><h3 className="font-semibold">Блюда</h3><div className="flex gap-2"><input value={filter} onChange={e=>setFilter(e.target.value)} placeholder="Поиск…" className="bg-black/30 border border-white/10 rounded-lg px-3 py-2"/><button className="px-3 py-2 rounded-lg border border-white/10" onClick={addItem}>Добавить блюдо</button></div></div><div className="overflow-auto"><table className="min-w-full text-sm"><thead><tr className="text-left text-gray-300"><th className="pr-2 py-2">ID</th><th className="pr-2">Категория</th><th className="pr-2">RU</th><th className="pr-2">EN</th><th className="pr-2">Цена</th><th></th></tr></thead><tbody className="align-top">{items.map(it=>(<tr key={it.id} className="border-t border-white/10"><td className="pr-2 py-2">{it.id}</td><td className="pr-2">{it.category}</td><td className="pr-2">{it.title_ru}</td><td className="pr-2">{it.title_en}</td><td className="pr-2">{it.price}</td><td className="pr-2"><button className="px-2 py-1 rounded-lg border border-white/10 mr-1" onClick={()=>editItem(it)}>Редакт.</button><button className="px-2 py-1 rounded-lg border border-white/10" onClick={()=>delItem(it.id)}>Удалить</button></td></tr>))}</tbody></table></div></section>
{edit&&(<div className="fixed inset-0 bg-black/60 flex items-center justify-center p-4"><div className="bg-[#121216] border border-white/10 rounded-2xl p-4 w-full max-w-2xl"><h3 className="font-semibold mb-2">Редактирование блюда</h3><div className="grid grid-cols-2 gap-2">{["id","category","title_ru","title_en","price"].map(k=>(<label key={k} className="text-xs text-gray-300 flex flex-col"><span className="text-gray-400">{k}</span><input className="bg-black/30 border border-white/10 rounded-lg px-3 py-2" value={edit[k]} onChange={e=>setEdit({...edit,[k]:k==='price'?parseInt(e.target.value||0):e.target.value})}/></label>))}<label className="text-xs text-gray-300 col-span-2 flex flex-col"><span className="text-gray-400">desc_ru</span><textarea className="bg-black/30 border border-white/10 rounded-lg px-3 py-2" rows="3" value={edit.desc_ru||''} onChange={e=>setEdit({...edit,desc_ru:e.target.value})}></textarea></label><label className="text-xs text-gray-300 col-span-2 flex flex-col"><span className="text-gray-400">desc_en</span><textarea className="bg-black/30 border border-white/10 rounded-lg px-3 py-2" rows="3" value={edit.desc_en||''} onChange={e=>setEdit({...edit,desc_en:e.target.value})}></textarea></label></div><div className="mt-3 flex justify-end gap-2"><button className="px-3 py-2 rounded-lg border border-white/10" onClick={()=>setEdit(null)}>Отмена</button><button className="px-3 py-2 rounded-lg btn-grad" onClick={saveItem}>Сохранить</button></div></div></div>)}
</div>)}
ReactDOM.createRoot(document.getElementById("root")).render(<App/>)</script></body></html>